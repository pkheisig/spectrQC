% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/unmixing_matrix.R
\name{derive_unmixing_matrix}
\alias{derive_unmixing_matrix}
\title{Derive Unmixing Matrix from Reference Matrix}
\usage{
derive_unmixing_matrix(M, method = "OLS", global_weights = NULL)
}
\arguments{
\item{M}{Reference matrix (Markers x Detectors)}

\item{method}{Unmixing method ("OLS" or "WLS")}

\item{global_weights}{Optional vector of weights for WLS (one per detector)}
}
\value{
A matrix of unmixing coefficients (Markers x Detectors)
}
\description{
Calculates the analytical unmixing matrix from a reference spectral matrix (M).
The output matrix (W) has the same dimensions as M (Markers x Detectors).
To unmix data manually: Unmixed_Data = Raw_Data %*% t(W)
}
\examples{
M <- matrix(c(1, 0.2, 0.1, 1), nrow = 2, byrow = TRUE)
rownames(M) <- c("FITC", "PE")
colnames(M) <- c("B2-A", "YG1-A")
W <- derive_unmixing_matrix(M, method = "OLS")
W
}
