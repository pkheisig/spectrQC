% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_residuals.R
\name{calc_residuals}
\alias{calc_residuals}
\title{Calculate unmixing residuals}
\usage{
calc_residuals(
  flow_frame,
  M,
  file_name = NULL,
  method = "OLS",
  background_noise = 25,
  return_residuals = FALSE
)
}
\arguments{
\item{flow_frame}{A flowFrame object with raw fluorescence data}

\item{M}{Reference matrix (fluorophores x detectors)}

\item{file_name}{Optional file name to add to output}

\item{method}{Unmixing method: "OLS" (default), "NNLS", or "WLS" (per-cell weighted)}

\item{background_noise}{Baseline electronic noise variance (default: 25)}

\item{return_residuals}{Logical. If TRUE, returns a list containing the unmixed data and the raw residual matrix.}
}
\value{
Data frame with unmixed abundances, RMSE, Relative_RMSE, and scatter parameters. 
        If return_residuals=TRUE, returns a list with [[data]] and [[residuals]].
}
\description{
Calculate unmixing residuals
}
\examples{
\dontrun{
ff <- flowCore::read.FCS("samples/Sample1.fcs", transformation = FALSE)
res <- calc_residuals(
  flow_frame = ff,
  M = M,
  method = "WLS",
  return_residuals = TRUE
)
head(res$data)
}
}
