% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/diagnostic_plots.R
\name{plot_detector_residuals}
\alias{plot_detector_residuals}
\title{Plot Detector-Level Residuals}
\usage{
plot_detector_residuals(
  res_list,
  M,
  top_n = 50,
  output_file = "detector_residuals.png",
  width = 250,
  height = 120,
  pd = NULL
)
}
\arguments{
\item{res_list}{List returned by calc_residuals with return_residuals=TRUE}

\item{M}{Reference matrix}

\item{top_n}{Number of top high-error cells to analyze}

\item{output_file}{Path to save the plot}

\item{width}{Plot width.}

\item{height}{Plot height.}

\item{pd}{Optional pData for descriptive labels}
}
\value{
A `ggplot` object or `NULL` when residuals are unavailable.
}
\description{
Identifies which detectors contribute most to the unmixing error for high-RRMSE cells.
Overlays the reference signatures to help identify the source of the mismatch.
}
\examples{
args(plot_detector_residuals)
\dontrun{
p <- plot_detector_residuals(res_list[[1]], M, top_n = 50)
print(p)
}
}
