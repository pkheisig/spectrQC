% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gate_positive_cells.R
\name{gate_positive_cells}
\alias{gate_positive_cells}
\title{Gate Positive Events from a Single-Stain Matrix}
\usage{
gate_positive_cells(
  mat,
  histogram_pct = 0.98,
  histogram_direction = "both",
  histogram_min_x_log = 2
)
}
\arguments{
\item{mat}{Numeric matrix/data.frame of events x detectors.}

\item{histogram_pct}{Fraction of events retained by the histogram gate.}

\item{histogram_direction}{Gate direction: `"both"`, `"left"`, or `"right"`.}

\item{histogram_min_x_log}{Reserved minimum x value on log10 scale.}
}
\value{
Logical vector of length `nrow(mat)`, `TRUE` for gated-in events.
}
\description{
Performs one-dimensional histogram gating on the channel with highest variance.
The function returns a logical vector indicating events inside the positive gate.
}
\examples{
set.seed(1)
mat <- cbind(
  ch1 = c(rlnorm(500, 2, 0.4), rlnorm(500, 5, 0.3)),
  ch2 = rlnorm(1000, 2.5, 0.4)
)
idx <- gate_positive_cells(mat, histogram_pct = 0.4, histogram_direction = "right")
mean(idx)
}
